<odoo>
  <data>

    <record id="training_tree" model="ir.ui.view">
        <field name="name">training.tree</field>
        <field name="model">training</field>
        <field name="arch" type="xml">
            <tree decoration-success="state=='training_closed'" default_order="id desc">
              <field name="id" string="ID"/>
              <field name="start"/>
              <field name="partner_id"/>
              <field name="name"/>
              <field name="sales_manager"/>
              <field name="consultant_id"/>
              <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="training_search" model="ir.ui.view">
        <field name="name">training.search</field>
        <field name="model">training</field>
        <field name="arch" type="xml">
            <search>
                <field name="id" filter_domain="[('id', '=', self)]"/>
                <field name="name" filter_domain="[('name', 'ilike', self)]"/>
                <field name="partner_id" filter_domain="[('partner_id', 'ilike', self)]"/>
                <field name="sales_manager" filter_domain="[('sales_manager', 'ilike', self)]"/>
                <field name="consultant_id" filter_domain="[('consultant_id', 'ilike', self)]"/>
                <filter string="Formations ouvertes" name="filter_open_training" domain="[('state', '!=', 'training_closed')]"/>
                <filter string="Formations cloturées" name="filter_closed_training" domain="[('state', '=', 'training_closed')]"/>
                <separator/>
                <filter string="Formations OPCO" name="filter_opco" domain="[('opco_file', '!=', False)]"/>
                <filter string="Formations non OPCO" name="filter_non_opco" domain="[('opco_file', '=', False)]"/>
                <separator/>
                <filter string="Archivé" name="inactive" domain="[('active','=', False)]"></filter>
                <group expand="0" string="Group By">
                    <filter string="Client" name="group_by_partner_id" context="{'group_by':'partner_id'}"/>
                    <filter string="Date de début" name="group_by_start" context="{'group_by':'start'}"/>
                    <filter string="Commercial" name="group_by_sales_manager" context="{'group_by':'sales_manager'}"/>
                    <filter string="Consultant" name="group_by_consultant_id" context="{'group_by':'consultant_id'}"/>
                    <filter string="Produit" name="group_by_type_product_id" context="{'group_by':'type_product_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="training_action" model="ir.actions.act_window">
        <field name="name">Formations</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">training</field>
        <field name="view_mode">tree,kanban,form,pivot</field>
        <field name="context">{"search_default_filter_open_training":1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Il n'y a pas de formation
            </p>
        </field>
    </record>

    <record id="training_form" model="ir.ui.view">
        <field name="name">training.form</field>
        <field name="model">training</field>
        <field name="arch" type="xml">
            <form>
                <header>
                  <field name="state" widget="statusbar" statusbar_visible="unassigned,commercial_part,consultant_part,training_in_progress,training_ended,training_closed"/>
                  <button name="button_switch_commercial_part" string="Passer à la partie: commerciale" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'unassigned')]}"/>
                  <button name="button_return_unassigned" string="Revenir à la partie: non assigné" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'commercial_part')]}"/>
                  <button name="button_switch_consultant_part" string="Passer à la partie: consultant" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'commercial_part')]}"/>
                  <button name="button_return_commercial_part" string="Revenir à la partie: commerciale" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'consultant_part')]}"/>
                  <button name="button_switch_training_in_progress_part" string="Passer à la partie: formation en cours" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'consultant_part')]}"/>
                  <button name="button_return_consultant_part" string="Revenir à la partie: consultant" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'training_in_progress')]}"/>
                  <button name="button_switch_training_ended_part" string="Passer à la partie: formation terminée" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'training_in_progress')]}"/>
                  <button name="button_return_training_in_progress_part" string="Revenir à la partie: formation en cours" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'training_ended')]}"/>
                  <button name="button_switch_training_closed_part" string="Passer à la partie: formation cloturée" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'training_ended')]}"/>
                  <button name="button_return_training_ended_part" string="Revenir à la partie: formation terminée" type="object" class="oe_highlight" attrs="{'invisible': [('state',  '!=', 'training_closed')]}"/>

                  <button name="button_download_attendance_sheet" string="Feuille d'émargement" type="object"  icon="fa-download" class="btn-warning" attrs="{'invisible': ['|','|',('state',  '==', 'unassigned'),('state',  '==', 'commercial_part'),('state',  '==', 'training_closed')]}"/>
                  <button name="button_download_certificate_of_attendance" string="Attestation de présence au stage" type="object"  icon="fa-download" class="btn-warning" attrs="{'invisible': ['|','|',('state',  '==', 'unassigned'),('state',  '==', 'commercial_part'),('state',  '==', 'training_closed')]}"/>

                  <!--<button name="button_download_all_documents" string="Télécharger les documents de cette formation" type="object"  icon="fa-download" attrs="{'invisible': [('state',  '!=', 'training_closed')]}"/>-->
                </header>
                <sheet>
                  <field name="active" invisible="True"/>
                  <div class="oe_button_box" name="button_box">
                    <field name="sale_id" invisible="True"/>
                    <button name="action_open_sale_id" string="Ouvrir le devis" type="object" class="oe_link" icon="fa-file-text-o" attrs="{'invisible': [('sale_id', '=', False)]}"/>
                  </div>
                  <group>
                    <field name="sale_id" required="True" readonly="True"/>
                    <field name="name" required="True"/>
                  </group>
                  <!-- Partie non assigné -->
                  <div>
                    <separator style="font-size:20px;color: #539314;" string="-&gt; Non assigné" attrs="{'invisible': [('state',  '!=', 'unassigned')]}"/>
                    <separator style="font-size:16px;" string="Non assigné" attrs="{'invisible': [('state',  '=', 'unassigned')]}" />
                    <p attrs="{'invisible': [('state',  '!=', 'unassigned')]}">
                      <strong>Étape 1 / 1 :</strong>
                      Désigner un responsable commercial pour ce dossier et inclure le devis signé.
                    </p>
                    <group>
                      <field name="sales_manager" widget="many2one_avatar_user" attrs="{'readonly': [('state',  '!=', 'unassigned')]}"/>
                      <field name="signed_quote" attrs="{'readonly': [('state',  '!=', 'unassigned')]}"/>
                    </group>
                  </div>
                  <!-- Partie commerciale -->
                  <div attrs="{'invisible': [('state',  '==', 'unassigned')]}">
                    <separator style="font-size:20px;color: #539314;" string="-&gt; Partie commerciale" attrs="{'invisible': [('state',  '!=', 'commercial_part')]}"/>
                    <separator style="font-size:16px;" string="Partie commerciale" attrs="{'invisible': [('state',  '=', 'commercial_part')]}" />
                    <p attrs="{'invisible': [('state',  '!=', 'commercial_part')]}">
                      <strong>Étape 1 / 5 :</strong>
                      Sélectionner le référent client.
                    </p>
                    <group>
                      <group>
                        <field name="partner_id" attrs="{'readonly': [('state',  '!=', 'commercial_part')]}"/>
                      </group>
                      <group>
                        <field name="partner_manager_id" domain="[('parent_id','=',partner_id)]" attrs="{'readonly': ['|',('partner_id',  '=', False),('state',  '!=', 'commercial_part')]}"/>
                      </group>
                    </group>
                    <p attrs="{'invisible': [('state',  '!=', 'commercial_part')]}">
                      <strong>Étape 2 / 5 :</strong>
                      - Sélectionnez le type de formation, le produit ainsi que le plan de formation. S’assurer qu’un document PDF est renseigné pour ce plan de formation ( Barre supérieure -> Configuration -> Plan de Formation).
                      <br/>
                      - Sélectionner l’OPCO et inclure le document OPCO, cette tâche n’est pas obligatoire et peut-être réalisée plus tard.
                      <br/>
                      - Déposer le diagnostic initial rempli par le client.
                    </p>
                    <group>
                      <group>
                        <field name="company_id" options="{'no_create': True, 'no_create_edit':True}" attrs="{'readonly': [('state',  '!=', 'commercial_part')]}"/>
                      </group>
                      <group>
                        <field name="type_id" options="{'no_create': True, 'no_create_edit':True}" attrs="{'readonly': [('state',  '!=', 'commercial_part')]}"/>
                      </group>
                      <group>
                        <field name="opco_id" attrs="{'readonly': [('state',  '!=', 'commercial_part')]}"/>
                      </group>
                      <group>
                        <field name="type_product_id" domain="[('type_id','=',type_id)]" attrs="{'readonly': ['|',('type_id',  '=', False),('state',  '!=', 'commercial_part')]}" options="{'no_create': True, 'no_create_edit':True}"/>
                      </group>
                      <group>
                        <field name="opco_file" attrs="{'readonly': [('state',  '!=', 'commercial_part')]}"/>
                      </group>
                      <group>
                        <field name="type_product_plan_id" domain="['&amp;',('type_id','=',type_id),('product_id','=',type_product_id)]" attrs="{'readonly': ['|',('type_product_id',  '=', False),('state',  '!=', 'commercial_part')]}" options="{'no_create': True, 'no_create_edit':True}"/>
                      </group>
                      <group>
                        <field name="diagnosis_file" attrs="{'readonly': [('state',  '!=', 'commercial_part')]}"/>
                      </group>
                    </group>
                    <p attrs="{'invisible': [('state',  '!=', 'commercial_part')]}">
                      <strong>Étape 3 / 5 :</strong>
                      - Indiquer les participants à la formation : Nom, Fonction, e-mail. Le téléphone est facultatif.
                      <br/>
                      Il est possible de sélectionner directement une personne présente en base de données via le champ «Référence du contact»
                    </p>
                    <group>
                      <field name="training_participants" attrs="{'invisible': [('state',  '!=', 'commercial_part')]}" readonly="False">
                      </field>
                    </group>
                    <p attrs="{'invisible': [('state',  '!=', 'commercial_part')]}">
                      <strong>Étape 4 / 5 :</strong>
                      - Remplir les champs de rédaction de la convention. La durée est fixée à celle présente dans le devis.
                      <br/>
                      La signature présente à la fin de la convention sera celle du signataire interne.
                      <br/>
                      - Télécharger la convention pour la vérifier et l’envoyer au client.
                    </p>
                    <div style="margin-left:30px;" attrs="{'invisible': [('state',  '!=', 'commercial_part')]}">
                      <separator string="Rédaction de le convention" style="color:red;"/>
                      <group>
                      <field name="course_title"/>
                      <field name="location" options="{'no_create': True, 'no_create_edit':True}"/>
                      </group>
                      <group>
                        <group>
                          <field name="start"/>
                        </group>
                        <group>
                          <field name="end"/>
                        </group>
                        <group>
                          <field name="agreement_internal_signer" options="{'no_create': True, 'no_create_edit':True}"/>
                        </group>
                        <group>
                          <field name="duration"/>
                        </group>
                        <group>
                        </group>
                        <group>
                          <field name="duration_hours"/>
                        </group>
                      </group>
                      <button name="download_training_agreement" string="Télécharger la convention de formation" type="object" class="oe_highlight"/>
                      <button name="send_training_agreement" string="Envoyer la convention de formation au référent client" type="object" class="oe_highlight oe_right"/>
                    </div>
                    <br/>
                    <p attrs="{'invisible': [('state',  '!=', 'commercial_part')]}">
                      <strong>Étape 5 / 5 :</strong> Déposer la convention de formation signée par le client dans le champ ci-dessous
                    </p>
                    <group>
                      <field name="signed_agreement" attrs="{'readonly': [('state',  '!=', 'commercial_part')]}"/>
                    </group>
                  </div>
                  <!-- Partie consultant -->
                  <div attrs="{'invisible': ['|',('state',  '==', 'unassigned'),('state',  '==', 'commercial_part')]}">
                    <separator style="font-size:20px;color: #539314;" string="-&gt; Partie consultant" attrs="{'invisible': [('state',  '!=', 'consultant_part')]}"/>
                    <separator style="font-size:16px;" string="Partie consultant" attrs="{'invisible': [('state',  '=', 'consultant_part')]}" />

                    <group>
                      <field name="consultant_id" attrs="{'readonly': [('state',  '!=', 'consultant_part')]}"/>
                    </group>
                    <group>
                      <group>
                        <field name="remote_learning" attrs="{'readonly': [('state',  '!=', 'consultant_part')]}"/>
                      </group>
                      <group>
                        <field name="remote_learning_link" attrs="{'invisible': [('remote_learning',  '==', False)], 'required': [('remote_learning',  '=', True)], 'readonly': [('state',  '!=', 'consultant_part')]}"/>
                      </group>
                    </group>
                    <div attrs="{'invisible': [('remote_learning',  '=', True)]}">
                      <group>
                        <group>
                          <field name="location_selection" attrs="{'readonly': [('state',  '!=', 'consultant_part')]}"/>
                        </group>
                        <group>
                            <div attrs="{'invisible': [('location_selection',  '=', 'company')]}">
                                  <div class="o_address_format" name="div_address">
                                      <field name="location_street" placeholder="Rue..." class="o_address_street" attrs="{'readonly': [('location_selection',  '=', 'client')]}" force_save="1"/>
                                      <field name="location_street2" placeholder="Rue 2..." class="o_address_street" attrs="{'readonly': [('location_selection',  '=', 'client')]}" force_save="1"/>
                                      <field name="location_city" placeholder="Ville" class="o_address_city" attrs="{'readonly': [('location_selection',  '=', 'client')]}" force_save="1"/>
                                      <field name="location_zip" placeholder="Code postal" class="o_address_zip" attrs="{'readonly': [('location_selection',  '=', 'client')]}" force_save="1"/>
                                      <field name="location_country_id" placeholder="Pays" class="o_address_country" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" attrs="{'readonly': [('location_selection',  '=', 'client')]}" force_save="1"/>
                                  </div>
                            </div>
                        </group>
                      </group>
                      <p attrs="{'invisible': [('state',  '!=', 'consultant_part')]}">Aide : Cette adresse correspond au lieu où se déroulera la formation. Merci de bien vérifier son exactitude!</p>
                    </div>
                    <field name="planned_hours_alert" style="color: red;"/>
                    <group>
                      <field name="planned_hours_ids">
                        <tree string="Heures planifiées" default_order="start asc">
                          <field name="user_id" string="Organisateur"/>
                          <field name="start" string="Début"/>
                          <field name="stop" string="Fin"/>
                          <field name="duration" widget="float_time"/>
                          <button
                          name="training_remove_event_button"
                          string=""
                          class="oe_highlight btn-secondary"
                          type="object"
                          icon="fa-trash-o"
                          confirm="Êtes-vous sûr de supprimer cet évènement du calendrier ?" attrs="{'invisible': [('parent.state',  '!=', 'consultant_part')]}"/>
                        </tree>
                      </field>
                    </group>
                    <p attrs="{'invisible': [('state',  '!=', 'consultant_part')]}">Aide : Pour planifier des heures veuillez cliquer sur "Planifier un créneau de formation" ci-dessous et placer vos créneaux ou passer directement via l'application "Calendrier". Veillez à ce que la coche "Est une formation" soit cochée et que la bonne formation soit sélectionnée.</p>
                    <button name="button_plan_training_slot" string="Planifier un créneau de formation" type="object" icon="fa-plus-square" class="oe_highlight oe_right" attrs="{'invisible': [('state',  '!=', 'consultant_part')]}"/>
                    <group>
                      <field name="training_participants" readonly="True" force_save="1" attrs="{'invisible': [('state',  '!=', 'consultant_part')]}">
                      </field>
                    </group>
                    <button name="send_invitation_participants" string="Envoyer les invitations aux participants" type="object" class="oe_highlight oe_right" confirm="Vous allez envoyer les invitations à tous les participants où l'invitation n'a pas encore été envoyée. Souhaitez-vous continuer" attrs="{'invisible': [('state',  '!=', 'consultant_part')]}"/>
                  </div>
                  <!-- Formation en cours -->
                  <div attrs="{'invisible': [('state',  '!=', 'training_in_progress')]}">
                  <separator style="font-size:20px;color: #539314;" string="-&gt; Formation en cours" attrs="{'invisible': [('state',  '!=', 'training_in_progress')]}"/>
                  <separator style="font-size:16px;" string="Formation en cours" attrs="{'invisible': [('state',  '=', 'training_in_progress')]}" />

                  <group>
                    <field name="training_participants" force_save="1">
                    </field>
                  </group>
                  <button name="send_diagnostic_quiz_participants" string="Envoyer les quiz de diagnostic" type="object" class="oe_highlight oe_right" confirm="Vous allez envoyer les quiz à tous les participants où celui-ci n'a pas encore été envoyée. Souhaitez-vous continuer" attrs="{'invisible': [('state',  '!=', 'training_in_progress')]}"/>
                </div>
                <!-- Formation terminée -->
                <div attrs="{'invisible': ['|','|','|',('state',  '==', 'unassigned'),('state',  '==', 'commercial_part'),('state',  '==', 'consultant_part'),('state',  '==', 'training_in_progress')]}">
                <separator style="font-size:20px;color: #539314;" string="-&gt; Formation terminée" attrs="{'invisible': [('state',  '!=', 'training_ended')]}"/>
                <separator style="font-size:16px;" string="Formation terminée" attrs="{'invisible': [('state',  '=', 'training_ended')]}" />

                <field name="training_participants" readonly="False" force_save="1" attrs="{'invisible': [('state',  '!=', 'training_ended')]}">
                </field>
                  <button name="send_training_ended_participants" string="Envoyer les mails aux participants" type="object" class="oe_highlight oe_right" confirm="Vous allez envoyer les mails à tous les participants où celui-ci n'a pas encore été envoyée. Souhaitez-vous continuer ?" attrs="{'invisible': [('state',  '!=', 'training_ended')]}"/>
                  <div style="margin-left:30px;">
                    <separator string="Évaluation de la formation par le consultant" style="color:red;"/>
                    <group>
                      <group>
                        <field name="evaluating_training_course" attrs="{'readonly': [('state',  '!=', 'training_ended')]}"/>
                      </group>
                      <group>
                        <field name="difficulties_training_course" attrs="{'readonly': [('state',  '!=', 'training_ended')]}"/>
                      </group>
                    </group>
                    <button name="download_training_evaluation" string="Télécharger l'évaluation du consultant" type="object" class="oe_highlight oe_right"/>
                  </div>
                  <div style="margin-left:30px;">
                    <separator string="Feuille d'émargement remplie" style="color:red;"/>
                        <field name="signed_attendance_sheets" attrs="{'readonly': [('state',  '!=', 'training_ended')]}">
                          <tree>
                            <field name="name" invisible="True"/>
                            <field name="file" filename="name" widget="binary"/>
                          </tree>
                          <form>
                            <group>
                                <field name="name" invisible="True"/>
                                <field name="file" filename="name"/>
                            </group>
                          </form>
                        </field>
                  </div>
                </div>
                <!-- Formation cloturée -->
                <div attrs="{'invisible': ['|','|','|','|',('state',  '==', 'unassigned'),('state',  '==', 'commercial_part'),('state',  '==', 'consultant_part'),('state',  '==', 'training_in_progress'),('state',  '==', 'training_ended')]}">
                  <separator style="font-size:20px;color: #539314;" string="-&gt; Formation cloturée"/>
                  <group>
                    <field name="training_participants" readonly="True" force_save="1" attrs="{'invisible': [('state',  '!=', 'training_closed')]}">
                      <tree string="Liste des participants" decoration-success="is_rated==True">
                            <field name="name"/>
                            <field name="email"/>
                            <!--Partie consultant-->
                            <field name="invitation_sent" readonly="True" attrs="{'column_invisible': [('parent.state',  '!=', 'consultant_part')]}"/>
                            <field name="positioning_quiz_received" readonly="True" attrs="{'column_invisible': [('parent.state',  '!=', 'consultant_part')]}"/>
                            <button name="send_invitation_individual" string="Envoyer une invitation" type="object" class="oe_highlight oe_right" confirm="Vous allez envoyer une invitation, souhaitez-vous continuer" attrs="{'column_invisible': [('parent.state',  '!=', 'consultant_part')]}"/>
                            <!--Formation en cours-->
                            <field name="diagnostic_quiz_sent" readonly="True" attrs="{'column_invisible': [('parent.state',  '!=', 'training_in_progress')]}"/>
                            <field name="diagnostic_received" readonly="True" attrs="{'column_invisible': [('parent.state',  '!=', 'training_in_progress')]}"/>
                            <button name="send_diagnostic_quiz_individual" string="Envoyer le quiz de diagnostic" type="object" class="oe_highlight oe_right" confirm="Vous allez envoyer un quiz de diagnostic, souhaitez-vous continuer" attrs="{'column_invisible': [('parent.state',  '!=', 'training_in_progress')]}"/>
                            <!--Formation terminée-->
                            <field name="training_ended_sent" attrs="{'column_invisible': [('parent.state',  '!=', 'training_ended')]}"/>
                            <field name="prior_learning_quiz_received" attrs="{'column_invisible': [('parent.state',  '!=', 'training_ended')]}"/>
                            <field name="training_evaluation_received" attrs="{'column_invisible': [('parent.state',  '!=', 'training_ended')]}"/>
                            <field name="is_rated" attrs="{'column_invisible': [('parent.state',  '!=', 'training_ended')]}"/>
                            <button name="send_training_ended_individual" string="Envoyer les quiz" type="object" class="oe_highlight oe_right" confirm="Vous allez envoyer les quiz d'évaluation, souhaitez-vous continuer ?" attrs="{'column_invisible': [('parent.state',  '!=', 'training_ended')]}"/>
                            <button name="open_participant_button" string="Voir" type="object"  icon="fa-eye" class="btn-warning" attrs="{'invisible': [('parent.state',  '=', 'commercial_part')]}"/>
                      </tree>
                    </field>
                </group>
                  <group>
                    <field name="training_closed_date"/>
                  </group>
                  <div style="margin-left:30px;">
                    <p>Les quiz seront envoyé automatiquement 30 jours et 60 jours après la clôture de la formation, vous pouvez forcer l'envoi via les boutons "Envoyer l'évaluation maintenant" et "Envoyer le quiz maintenant".</p>
                    <separator string="Évaluation à froid du client (J+30)" style="color:red;"/>
                    <group>
                      <group>
                        <field name="delayed_assessment_sent"/>
                      </group>
                      <group>
                        <field name="delayed_assessment_received"/>
                      </group>
                    </group>
                    <button name="send_delayed_assessment_client" string="Envoyer l'évaluation maintenant" type="object" class="oe_highlight oe_right" confirm="Vous allez envoyer l'évaluation au client. Cette tâche est normalement effectuée automatiquement 30 jours après la fin de la formation. Souhaitez-vous continuer ?" attrs="{'invisible': [('delayed_assessment_received',  '=', True)]}"/>
                  </div>
                  <div style="margin-left:30px;">
                    <separator string="Évaluation de l'OPCO (J+60)" style="color:red;"/>
                    <group>
                      <group>
                        <field name="opco_quiz_sent"/>
                      </group>
                      <group>
                        <field name="opco_quiz_received"/>
                      </group>
                    </group>
                    <button name="send_opco_quiz" string="Envoyer le quiz maintenant" type="object" class="oe_highlight oe_right" confirm="Vous allez envoyer le quiz à l'OPCO maintenant. Cette tâche est normalement effectuée automatiquement 60 jours après la fin de la formation. Souhaitez-vous continuer ?" attrs="{'invisible': [('opco_quiz_received',  '=', True)]}"/>
                  </div>
                  <div style="margin-left:30px;" attrs="{'invisible': ['&amp;',('answer_delayed_assessment',  '==', False),('answer_opco_quiz',  '==', False)]}">
                    <separator string="Réponses aux quiz" style="color:green;"/>
                    <group>
                      <!-- Le système de notes pour ces quiz est déjà en place -->
                      <field name="answer_delayed_assessment" readonly="True"/>
                      <field name="answer_opco_quiz" readonly="True"/>
                    </group>
                  </div>
                </div>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!--=====PIVOT VIEW=====-->

    <!-- _TEMP TO REMOVE -->
    <!--<record id="training_pivot" model="ir.ui.view">
        <field name="name">training.pivot</field>
        <field name="type">pivot</field>
        <field name="model">training</field>
        <field name="arch" type="xml">
            <pivot string="Formations">

            </pivot>
        </field>
    </record>-->

    <!--===============Stats filters=============== -->

    <!--Pivot filters-->
    <record id="filter_all_time" model="ir.filters">
        <field name="name">Temps total</field>
        <field name="model_id">training</field>
        <field name="domain"></field>
        <field name="user_id" eval="False"/>
        <field name="context">{'group_by': [], 'pivot_measures': ['duration'], 'pivot_column_groupby': [], 'pivot_row_groupby': []}</field>
    </record>

    <!--<record id="filter_all_amount" model="ir.filters">
        <field name="name">Montant total</field>
        <field name="model_id">training</field>
        <field name="domain"></field>
        <field name="user_id" eval="False"/>
        <field name="context">{'group_by': [], 'pivot_measures': ['sale_price_total'], 'pivot_column_groupby': [], 'pivot_row_groupby': []}</field>
    </record>-->

    <!--<record id="filter_product_participant" model="ir.filters">
        <field name="name">Participants par produit</field>
        <field name="model_id">training</field>
        <field name="domain"></field>
        <field name="user_id" eval="False"/>
        <field name="context">{'group_by': [], 'pivot_measures': ['participants_count'], 'pivot_column_groupby': [], 'pivot_row_groupby': ['type_product_id']}</field>
    </record>-->

    <record id="filter_product_time" model="ir.filters">
        <field name="name">Temps par produit</field>
        <field name="model_id">training</field>
        <field name="domain"></field>
        <field name="user_id" eval="False"/>
        <field name="context">{'group_by': [], 'pivot_measures': ['duration'], 'pivot_column_groupby': [], 'pivot_row_groupby': ['type_product_id']}</field>
    </record>

    <!--<record id="filter_all_participants" model="ir.filters">
        <field name="name">Total des participants</field>
        <field name="model_id">training</field>
        <field name="domain"></field>
        <field name="user_id" eval="False"/>
        <field name="context">{'group_by': [], 'pivot_measures': ['participants_count'], 'pivot_column_groupby': [], 'pivot_row_groupby': []}</field>
    </record>-->

    <record id="filter_consultants_list" model="ir.filters">
        <field name="name">Liste des consultants</field>
        <field name="model_id">training</field>
        <field name="domain"></field>
        <field name="user_id" eval="False"/>
        <field name="context">{'group_by': [], 'pivot_measures': ['duration'], 'pivot_column_groupby': [], 'pivot_row_groupby': ['consultant_id']}</field>
    </record>

    <record id="filter_consultants_year" model="ir.filters">
        <field name="name">Liste des consultants par année</field>
        <field name="model_id">training</field>
        <field name="domain"></field>
        <field name="user_id" eval="False"/>
        <field name="context">{'group_by': [], 'pivot_measures': ['duration'], 'pivot_column_groupby': [], 'pivot_row_groupby': ['start:year', 'consultant_id']}</field>
    </record>

    <record id="filter_consultants_product" model="ir.filters">
        <field name="name">Liste des consultants par produit</field>
        <field name="model_id">training</field>
        <field name="domain"></field>
        <field name="user_id" eval="False"/>
        <field name="context">{'group_by': [], 'pivot_measures': ['duration'], 'pivot_column_groupby': [], 'pivot_row_groupby': ['type_product_id', 'consultant_id']}</field>
    </record>



    <record id="training_participants_form" model="ir.ui.view">
        <field name="name">training.participants.form</field>
        <field name="model">training.participants</field>
        <field name="arch" type="xml">
          <form>
            <group>
              <separator string="Utiliser un contact existant" style="font-size:16px;" />
            </group>
              <label for="partner_contact_id" string="Référence du contact : " style="font-size: 16px;"/>
              <field name="partner_contact_id" style="font-size: 16px;" nolabel="1"/>
            <group>
              <separator string="Données du contact"/>
              <field name="training_id" invisible="True"/>
              <field name="training_state" invisible="True"/>
              <field name="name" required="True"/>
              <field name="position" required="True"/>
              <field name="email" required="True"/>
              <field name="phone"/>
            </group>
            <div style="margin-left:30px;" attrs="{'invisible': ['&amp;',('training_state',  '!=', 'training_ended'),('training_state',  '!=', 'training_closed')]}">
            <separator string="Évaluation"/>
            <group>
                <group>
                  <field name="evaluation_engagment_mark" style="background:orange;color:black;"/>
                </group>
                <group>
                  <field name="training_end_mark" style="background:orange;color:black;"/>
                </group>
            </group>
            </div>
            <div attrs="{'invisible': ['|',('training_state',  '=', 'unassigned'),('training_state',  '=', 'commercial_part')]}">
              <separator string="Réponses aux quiz"/>
              <field name="diagnostic_received" invisible="True"/>
              <field name="positioning_quiz_received" invisible="True"/>
              <field name="prior_learning_quiz_received" invisible="True"/>
              <field name="training_evaluation_received" invisible="True"/>
              <div attrs="{'invisible': [('positioning_quiz_received',  '=', False)]}" style="margin-left:20px;">
                <separator string="Quiz de positionnement" style="font-size: 16px;"/>
                <div attrs="{'invisible': [('mark_positioning_quiz',  '=', -1)]}" style="color:#DCC222; font-size: 16px;">Note : <field name="mark_positioning_quiz" readonly="True"/></div>
                <field name="answer_positioning_quiz"/>
              </div>
              <div attrs="{'invisible': [('diagnostic_received',  '=', False)]}" style="margin-left:20px;">
                <separator string="Quiz diagnostic" style="font-size: 16px;"/>
                <div attrs="{'invisible': [('mark_quiz_diagnostic',  '=', -1)]}" style="color:#DCC222; font-size: 16px;">Note : <field name="mark_quiz_diagnostic" readonly="True"/></div>
                <field name="answer_quiz_diagnostic"/>
              </div>
              <div attrs="{'invisible': [('prior_learning_quiz_received',  '=', False)]}" style="margin-left:20px;">
                <separator string="Quiz de validation des acquis" style="font-size: 16px;"/>
                <div attrs="{'invisible': [('mark_prior_learning_quiz',  '=', -1)]}" style="color:#DCC222; font-size: 16px;">Note : <field name="mark_prior_learning_quiz" readonly="True"/></div>
                <field name="answer_prior_learning_quiz"/>
              </div>
              <div attrs="{'invisible': [('training_evaluation_received',  '=', False)]}" style="margin-left:20px;">
                <separator string="Quiz évaluation formation" style="font-size: 16px;"/>
                <div attrs="{'invisible': [('mark_training_evaluation',  '=', -1)]}" style="color:#DCC222; font-size: 16px;">Note : <field name="mark_training_evaluation" readonly="True"/></div>
                <field name="answer_training_evaluation"/>
              </div>
            </div>
          </form>
        </field>
    </record>

    <!--Configuration Type/Produit/Plan de formation-->
    <record id="training_type_action" model="ir.actions.act_window">
        <field name="name">Type de formation</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">training.type</field>
        <field name="view_mode">tree,form</field>
    </record>
    <record id="training_type_product_action" model="ir.actions.act_window">
        <field name="name">Produit</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">training.type.product</field>
        <field name="view_mode">tree,form</field>
    </record>
    <record id="training_type_product_plan_action" model="ir.actions.act_window">
        <field name="name">Plan de formation</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">training.type.product.plan</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="training_type_product_plan_form" model="ir.ui.view">
        <field name="name">training.type.product.plan.form</field>
        <field name="model">training.type.product.plan</field>
        <field name="arch" type="xml">
          <form>
            <sheet>
              <group>
                <field name="type_id"/>
                <field name="product_id" attrs="{'readonly': [('type_id',  '=', False)]}" domain="[('type_id','=',type_id)]"/>
                <field name="name"/>
                <field name="training_plan_file"/>
              </group>
            </sheet>
          </form>
        </field>
    </record>

    <!--Configuration localisation de la formation-->
    <record id="training_location_action" model="ir.actions.act_window">
        <field name="name">Localisation de la formation</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">training.location</field>
        <field name="view_mode">tree,form</field>
    </record>

    <!--Configuration OPCO-->
    <record id="training_opco_action" model="ir.actions.act_window">
        <field name="name">Liste des OPCO</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">training.opco</field>
        <field name="view_mode">tree,form</field>
    </record>

    <!--==========AUTOMATED ACTIONS==========-->

    <record id="automating_closed_training" model="ir.cron">
        <field name="name">Automatisation - Formation cloturée</field>
        <field name="model_id" ref="model_training"/>
        <field name="type">ir.actions.server</field>
        <field name="state">code</field>
        <field name="code">model.automating_closed_training()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="numbercall">-1</field>
    </record>

    <!--==========MENU==========-->

    <!--Training-->
    <menuitem id="training_root"
              name="Formations"
              web_icon="training,static/description/icon.png"
              sequence="10"/>

    <menuitem id="training_training_root"
              parent="training_root"
              name="Formations"
              action="training_action"
              sequence="10"/>
    <!--Configuration-->
    <menuitem id="training_configuration_root"
              parent="training_root"
              name="Configuration"
              sequence="20"/>
    <!--Configuration Type/Produit/Plan de formation-->
    <menuitem id="training_configuration_type"
              parent="training_configuration_root"
              name="Type de formation"
              action="training_type_action"
              sequence="5"/>
    <menuitem id="training_configuration_type_product"
              parent="training_configuration_root"
              name="Produit"
              action="training_type_product_action"
              sequence="5"/>
    <menuitem id="training_configuration_type_product_plan"
              parent="training_configuration_root"
              name="Plan de formation"
              action="training_type_product_plan_action"
              sequence="5"/>
    <!--Configuration Localisation de la formation-->
    <menuitem id="training_configuration_location"
              parent="training_configuration_root"
              name="Localisation"
              action="training_location_action"
              sequence="10"/>


    <!--Configuration - OPCO-->

    <menuitem id="training_configuration_opco"
              parent="training_configuration_root"
              name="OPCO"
              action="training_opco_action"
              sequence="10"/>



  </data>
</odoo>


