<odoo>
  <data>
<record id="sinergis_helpdesk_ticket_blacklist_action" model="ir.actions.act_window">
    <field name="name">Sinergis Helpdesk Ticket Blacklist Action</field>
    <field name="type">ir.actions.act_window</field>
    <field name="res_model">helpdesk.ticket.blacklist</field>
    <field name="view_mode">tree,form</field>
</record>

<record id="sinergis_helpdesk_ticket_blacklist_tree" model="ir.ui.view">
        <field name="name">Sinergis Helpdesk Ticket Blacklist Tree</field>
        <field name="model">helpdesk.ticket.blacklist</field>
        <field name="arch" type="xml">
            <tree>
              <field name="email"/>
            </tree>
        </field>
  </record>

  <record id="sinergis_helpdesk_ticket_blacklist_search" model="ir.ui.view">
        <field name="name">Sinergis Helpdesk Ticket Blacklist Search</field>
        <field name="model">helpdesk.ticket.blacklist</field>
        <field name="arch" type="xml">
            <search>
            </search>
        </field>
    </record>

<record id="sinergis_helpdesk_ticket_blacklist_form" model="ir.ui.view">
        <field name="name">Sinergis Helpdesk Ticket Blacklist Form</field>
        <field name="model">helpdesk.ticket.blacklist</field>
        <field name="arch" type="xml">
          <form duplicate="false">
            <group>
              <field name="email"/>
             </group>
          </form>
        </field>
</record>

<menuitem id="sinergis_helpdesk_ticket_blacklist_menu" name="Blacklist" action="sinergis_helpdesk_ticket_blacklist_action"
        sequence="0" parent="helpdesk.helpdesk_menu_config"
        groups="base.group_user"/>

<!-- AUTOMATION -->


    <record id="sinergis_helpdesk_ticket_blacklist_automation" model="base.automation">
        <field name="name">Ticket Blacklist Automation</field>
        <field name="model_id" ref="mail.mail_message"/>
        <field name="state">code</field>
        <field name="code">
if record.res_id:
  ticket = env['helpdesk.ticket'].search([('id','=',record.res_id)]) # SÃ©lection du ticket
  if self.env['helpdesk.ticket.blacklist'].search(('email', '=', ticket.email)):  # If email in blacklist
    ticket.unlink()
        </field>
        <field name="trigger">on_create</field>
        <field name="active" eval="True"/>
    </record>


  </data>
</odoo>
