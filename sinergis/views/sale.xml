<odoo>
  <data>

    <record id="sinergis_inherited_saler_order" model="ir.ui.view">
        <field name="name">sinergis.inherited.sale.order</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="priority" eval="10"/>
        <field name="arch" type="xml">


          <xpath expr="//header" position="after">
            <field name="x_sinergis_sale_order_client_bloque" invisible="True"/>
            <field name="x_sinergis_sale_order_client_douteux" invisible="True"/>
            <field name="x_sinergis_sale_order_client_suspect" invisible="True"/>
            <div class="alert alert-info" role="alert" style="height: 40px; margin-bottom:0px;background-color:#875053;color:white;" attrs="{'invisible': [('x_sinergis_sale_order_client_bloque',  '=', False)]}">
                  Attention! Le client est <strong>bloqué</strong>!. Vous ne pouvez pas confirmer le devis.
            </div>
            <div class="alert alert-info" role="alert" style="height: 40px; margin-bottom:0px;background-color:#875053;color:white;" attrs="{'invisible': ['|',('x_sinergis_sale_order_client_douteux',  '=', False),('x_sinergis_sale_order_client_bloque',  '=', True)]}">
                  Attention! Le client est <strong>douteux</strong>!.
            </div>
            <div class="alert alert-info" role="alert" style="height: 40px; margin-bottom:0px;background-color:#A7A7A7;color:white;" attrs="{'invisible': [('x_sinergis_sale_order_client_suspect',  '=', False)]}">
                  Le client est enregistré comme suspect, vous ne pouvez pas confirmer le devis.
            </div>
          </xpath>

          <!-- Empecher de confirmer le devis si le client est bloqué -->
          <xpath expr="//button[@name='action_confirm'][1]" position="attributes">
            <attribute name="attrs">{'invisible': ['|','|',('x_sinergis_sale_order_client_bloque',  '=', True),('x_sinergis_sale_order_client_suspect',  '=', True),('state', 'not in', ['sent'])]}</attribute>
          </xpath>
          <xpath expr="//button[@name='action_confirm'][2]" position="attributes">
            <attribute name="attrs">{'invisible': ['|','|',('x_sinergis_sale_order_client_bloque',  '=', True),('x_sinergis_sale_order_client_suspect',  '=', True),('state', 'not in', ['draft'])]}</attribute>
          </xpath>


            <xpath expr="//field[@name='partner_id']" position="before">
                <field name="x_sinergis_sale_order_objet" placeholder="Objet du devis..."/>
            </xpath>

            <xpath expr="//field[@name='partner_id']" position="attributes">
                <attribute name="string">Société</attribute>
                <attribute name="domain">[('is_company','=',True)]</attribute>
                <attribute name="attrs">{'readonly': [('state','not in','draft')], 'required': True}</attribute>
            </xpath>
            <xpath expr="//field[@name='partner_invoice_id']" position="attributes">
                <attribute name="domain">[('is_company','=',True)]</attribute>
            </xpath>
            <xpath expr="//field[@name='partner_shipping_id']" position="attributes">
                <attribute name="domain">[('is_company','=',True)]</attribute>
            </xpath>

            <xpath expr="//field[@name='partner_invoice_id']" position="before">
                <field name="x_sinergis_sale_order_contact" domain="[('parent_id','=',partner_id),('x_sinergis_societe_contact_inactive','=',False)]" attrs="{'readonly': [('partner_id',  '=', False)]}" options="{'no_create': True, 'no_create_edit':True}"/>
                <br/>
                <br/>
            </xpath>

            <!-- MODIFICATION DE LA LISTE -->
            <xpath expr="//field[@name='order_line']//field[@name='product_id'][1]" position="attributes">
                <attribute name="options">{'no_create': True, 'no_create_edit':True}</attribute>
            </xpath>
            <xpath expr="/form/sheet/notebook/page/field/tree/field[@name='product_id'][1]" position="attributes">
                <attribute name="options">{'no_create': True, 'no_create_edit':True}</attribute>
            </xpath>


            <xpath expr="//group[@name='utm_link']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//field[@name='payment_term_id']" position="attributes">
                <attribute name="required">1</attribute>
                <attribute name="default">3</attribute>
            </xpath>

            <xpath expr="//field[@name='require_signature']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//field[@name='require_payment']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//group[@name='technical']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//group[@name='utm_link']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

        </field>
    </record>

    <record id="sinergis_inherited_management_saler_order" model="ir.ui.view">
        <field name="name">sinergis.inherited.management.sale.order</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_management.sale_order_form_quote"/>
        <field name="priority" eval="10"/>
        <field name="arch" type="xml">
          <xpath expr="//page[@name='other_information']" position="after">
              <xpath expr="//page[@name='optional_products']" position="move"/>
          </xpath>
          <xpath expr="//page[@name='optional_products']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
        </field>
      </record>

    <!-- TREE VIEW  -->

    <record id="sinergis_inherited_saler_order_tree" model="ir.ui.view">
        <field name="name">sinergis.inherited.sale.order.tree</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_quotation_tree_with_onboarding"/>
        <field name="priority" eval="10"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='create_date']" position="after">
                <field name="x_sinergis_sale_order_objet" readonly="1" decoration-bf="1"/>
            </xpath>
            <xpath expr="//field[@name='company_id']" position="replace">
            </xpath>
            <xpath expr="//field[@name='state']" position="after">
                <field name="company_id" optional="show" readonly="1" on_change="1" can_create="true" can_write="true" modifiers="{&quot;readonly&quot;: true, &quot;required&quot;: true}"/>
            </xpath>

        </field>
    </record>

    <!-- DANS LA LISTE DES ELEMENTS DU DEVIS, METTRE LE COUT PAR DEFAUT -->
    <record id="sinergis_inherited_margin_sale_order_line_form" model="ir.ui.view">
        <field name="name">sinergis.inherited.margin.sale.order.line.form</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_margin.sale_margin_sale_order_line_form"/>
        <field name="priority" eval="10"/>
        <field name="arch" type="xml">
          <xpath expr="//field[@name='purchase_price']" position="attributes">
            <attribute name="optional"></attribute>
          </xpath>
        </field>
    </record>

  </data>
</odoo>
